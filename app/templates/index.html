<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Motor de Inferencia de Sentimientos | AnÃ¡lisis de Emociones</title>
    <meta name="description" content="Analiza el sentimiento de frases en espaÃ±ol. Detecta si un texto es positivo, negativo o neutral." />
    <meta property="og:title" content="Motor de Sentimientos" />
    <meta property="og:description" content="Analiza emociones en espaÃ±ol: positivo, negativo o neutral." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="/" />
    <meta name="twitter:card" content="summary" />
    <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
    <nav class="nav">
        <div class="nav__brand">
            <img src="/static/favicon.svg" alt="logo" width="24" height="24" />
            <span>SentimetrÃ­a</span>
        </div>
        <div class="nav__links">
            <a href="#features">CaracterÃ­sticas</a>
            <a href="#precio">Precios</a>
            <a class="btn--ghost" href="#analizar">Demo</a>
            <a class="btn" href="#analizar">Probar gratis</a>
        </div>
    </nav>

    <div class="container">
        <section class="hero">
            <div class="hero__copy">
                <h1>Analiza sentimientos en segundos</h1>
                <p class="lead">Clasifica textos en <strong>positivo</strong>, <strong>negativo</strong> o <strong>neutral</strong> con un motor optimizado para espaÃ±ol.</p>
                <div class="hero__ctas">
                    <a class="btn" href="#analizar">Probar ahora</a>
                    <a class="btn--ghost" href="#features">Ver caracterÃ­sticas</a>
                </div>
            </div>
            <div class="hero__mock">
                <div class="device">
                    <div class="device__top"></div>
                    <div class="device__screen">
                        <div class="pill pill--pos">ğŸŸ¢ Excelente atenciÃ³n</div>
                        <div class="pill pill--neu">ğŸŸ¡ Aceptable, podrÃ­a mejorar</div>
                        <div class="pill pill--neg">ğŸ”´ PÃ©simo servicio</div>
                        <div class="pill pill--pos">ğŸŸ¢ Muy rÃ¡pido y amable</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="analizar" class="panel">
            <h2>Prueba la demo</h2>
            <p class="subtitle">Escribe una frase y detecta si es <strong>positiva</strong>, <strong>negativa</strong> o <strong>neutral</strong>.</p>

            <form id="analyze-form">
                <label for="text">Frase a analizar</label>
                <textarea id="text" name="text" rows="4" placeholder="Ej: excelente atenciÃ³n, muy rÃ¡pido y eficiente..." autocomplete="off" required></textarea>
                <button type="submit" id="submit-btn"><span class="btn-text">Analizar Sentimiento</span></button>
            </form>

            <div id="result" class="result hidden">
                <div class="badge" id="emoji">ğŸŸ¡</div>
                <div class="result-content">
                    <div class="sentiment" id="sentiment">moderado/neutral</div>
                    <div class="score" id="score">Score: 0.0</div>
                </div>
            </div>
        </section>

        <section id="features" class="features">
            <div class="feature">
                <div class="feat__icon">âš¡</div>
                <h3>Respuesta inmediata</h3>
                <p>Procesamiento en milisegundos con reglas optimizadas para espaÃ±ol.</p>
            </div>
            <div class="feature">
                <div class="feat__icon">ğŸ§ </div>
                <h3>Negaciones e intensificadores</h3>
                <p>Interpreta matices como â€œno muy buenoâ€ o â€œextremadamente Ãºtilâ€.</p>
            </div>
            <div class="feature">
                <div class="feat__icon">ğŸ¯</div>
                <h3>FÃ¡cil de integrar</h3>
                <p>API simple con `POST /analyze` para tus apps y automatizaciones.</p>
            </div>
        </section>

        <footer class="footer">
            <small>Â© SentimetrÃ­a â€” Demo educativa. <a href="/health">Status</a></small>
        </footer>
    </div>

    <div class="cookies" id="cookiebar">
        <span>Al utilizar este sitio aceptas nuestra polÃ­tica de cookies.</span>
        <button class="btn btn--small" id="cookiebtn">Aceptar</button>
    </div>

    <script>
        const form = document.getElementById('analyze-form');
        const textEl = document.getElementById('text');
        const resultEl = document.getElementById('result');
        const sentimentEl = document.getElementById('sentiment');
        const scoreEl = document.getElementById('score');
        const emojiEl = document.getElementById('emoji');
        const submitBtn = document.getElementById('submit-btn');
        const btnText = submitBtn.querySelector('.btn-text');

        function setBadgeColor(label) {
            resultEl.classList.remove('pos', 'neg', 'neu');
            if (label === 'positivo') {
                resultEl.classList.add('pos');
            } else if (label === 'negativo') {
                resultEl.classList.add('neg');
            } else {
                resultEl.classList.add('neu');
            }
        }

        function setLoading(loading) {
            if (loading) {
                form.classList.add('loading');
                submitBtn.disabled = true;
                btnText.textContent = 'Analizando...';
            } else {
                form.classList.remove('loading');
                submitBtn.disabled = false;
                btnText.textContent = 'Analizar Sentimiento';
            }
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const text = textEl.value.trim();
            
            if (!text) {
                return;
            }

            setLoading(true);
            resultEl.classList.add('hidden');

            try {
                const res = await fetch('/analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text }),
                });

                if (!res.ok) {
                    throw new Error(`Error ${res.status}: ${res.statusText}`);
                }

                const data = await res.json();
                
                sentimentEl.textContent = data.sentiment;
                scoreEl.textContent = `Score: ${data.score}`;
                emojiEl.textContent = data.emoji;
                setBadgeColor(data.sentiment);
                
                // Small delay for better UX
                setTimeout(() => {
                    resultEl.classList.remove('hidden');
                    setLoading(false);
                }, 300);

            } catch (err) {
                console.error('Error:', err);
                sentimentEl.textContent = 'Error analizando la frase';
                scoreEl.textContent = 'Por favor, intenta de nuevo';
                emojiEl.textContent = 'âš ï¸';
                setBadgeColor('');
                resultEl.classList.remove('hidden');
                setLoading(false);
            }
        });

        // Auto-resize textarea
        textEl.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        // Clear result when user starts typing
        textEl.addEventListener('input', function() {
            if (resultEl && !resultEl.classList.contains('hidden')) {
                resultEl.classList.add('hidden');
            }
        });

        // Cookie bar
        const cookiebar = document.getElementById('cookiebar');
        const cookiebtn = document.getElementById('cookiebtn');
        if (cookiebtn) {
            cookiebtn.addEventListener('click', () => {
                cookiebar.style.display = 'none';
            });
        }
    </script>
</body>
</html>
